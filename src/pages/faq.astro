---
import BaseLayout from '../layouts/BaseLayout.astro';
import SectionHeading from '../components/shared/SectionHeading.astro';
import CTAButton from '../components/shared/CTAButton.astro';
---

<BaseLayout
  title="CLIF Consortium - FAQ"
  description="Frequently asked questions about the Common Longitudinal ICU data Format (CLIF), including comparisons with other data models and how to get involved."
>
  <div class="container mx-auto px-4 py-8">
    <!-- Enhanced Page Header -->
    <div class="text-center mb-16">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-clif-burgundy/10 rounded-full mb-6">
        <svg class="w-10 h-10 text-clif-burgundy" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
      </div>
      <SectionHeading 
        title="Frequently Asked Questions" 
        subtitle="Everything you need to know about CLIF, how it compares to other data models, and how to join our growing consortium"
        align="center"
      />
    </div>

    <div class="flex flex-col lg:flex-row gap-8 max-w-7xl mx-auto">
      <!-- Quick Navigation Sidebar -->
      <aside class="hidden lg:block lg:w-64">
        <div class="sticky top-24">
          <h3 class="text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4">Quick Navigation</h3>
          <nav class="space-y-2">
            <a href="#comparison" class="flex items-center gap-2 text-gray-600 hover:text-clif-burgundy transition-colors p-2 rounded-lg hover:bg-gray-50">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
              </svg>
              <span class="text-sm">Comparisons</span>
            </a>
            <a href="#technical" class="flex items-center gap-2 text-gray-600 hover:text-clif-burgundy transition-colors p-2 rounded-lg hover:bg-gray-50">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
              </svg>
              <span class="text-sm">Technical Details</span>
            </a>
            <a href="#joining" class="flex items-center gap-2 text-gray-600 hover:text-clif-burgundy transition-colors p-2 rounded-lg hover:bg-gray-50">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/>
              </svg>
              <span class="text-sm">Getting Started</span>
            </a>
            <a href="#contact" class="flex items-center gap-2 text-gray-600 hover:text-clif-burgundy transition-colors p-2 rounded-lg hover:bg-gray-50">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
              </svg>
              <span class="text-sm">Contact</span>
            </a>
          </nav>
        </div>
      </aside>

      <!-- FAQ Content -->
      <div class="flex-1 space-y-6">
        
        <!-- Comparison Section -->
        <section id="comparison" class="scroll-mt-24">
          <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2">
            <span class="text-clif-burgundy">01</span>
            Comparisons
          </h2>
          
          <!-- OMOP Comparison -->
          <div class="faq-item bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover-lift mb-4 border border-gray-100 overflow-hidden">
            <button class="faq-trigger w-full text-left p-6 focus:outline-none focus:ring-2 focus:ring-clif-burgundy focus:ring-inset" aria-expanded="false">
              <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-clif-burgundy/10 to-clif-burgundy/20 rounded-xl flex items-center justify-center">
                  <svg class="w-6 h-6 text-clif-burgundy" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                  </svg>
                </div>
                <div class="flex-1">
                  <h3 class="text-xl font-semibold text-gray-900 mb-1">Why choose CLIF over OMOP?</h3>
                  <p class="text-gray-600 text-sm">Understanding the differences between data models</p>
                </div>
                <svg class="faq-chevron w-5 h-5 text-gray-400 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              </div>
            </button>
            <div class="faq-content hidden px-6 pb-6">
              <div class="ml-16 space-y-4">
                <p class="text-lg text-gray-700 leading-relaxed">
                  Most hospitals store patient information in electronic data warehouses (EDWs), which are designed to support a wide range of clinical and research needs. However, these systems often have different formats and coding practices, so researchers must spend a lot of time cleaning and organizing the data before it can be used.
                </p>
                <p class="text-lg text-gray-700 leading-relaxed">
                  Common data models like OMOP help standardize health data for general clinical research. While OMOP can include some ICU information, like ventilator settings, medication infusions, and life support treatments, this data is often incomplete or lacks the detailed timing needed to understand what happens in the ICU. This inconsistency makes it difficult to use OMOP for high-quality, multi-center ICU research.
                </p>
                <p class="text-lg text-gray-700 leading-relaxed">
                  CLIF was built specifically for ICU research. It focuses on the detailed, time-sensitive data that is unique to intensive care, such as real-time ventilator adjustments, drug titrations, and advanced life support. CLIF closely follows how ICU care is actually delivered, making it easier for researchers to study critical care patients across different hospitals in a consistent, accurate way.
                </p>
              </div>
            </div>
          </div>

          <!-- Epic Cosmos Comparison -->
          <div class="faq-item bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover-lift mb-4 border border-gray-100 overflow-hidden">
            <button class="faq-trigger w-full text-left p-6 focus:outline-none focus:ring-2 focus:ring-clif-burgundy focus:ring-inset" aria-expanded="false">
              <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-purple-100 to-purple-200 rounded-xl flex items-center justify-center">
                  <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                  </svg>
                </div>
                <div class="flex-1">
                  <h3 class="text-xl font-semibold text-gray-900 mb-1">How does CLIF compare to Epic Cosmos?</h3>
                  <p class="text-gray-600 text-sm">Open-source vs. proprietary solutions</p>
                </div>
                <svg class="faq-chevron w-5 h-5 text-gray-400 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              </div>
            </button>
            <div class="faq-content hidden px-6 pb-6">
              <div class="ml-16">
                <p class="text-lg text-gray-700 leading-relaxed">
                  CLIF is an open-source, federated solution that keeps data at each institution. This provides complete transparency 
                  in data definitions and allows institutions to maintain full control over their data while participating in 
                  multi-center research. The open-source nature ensures that all researchers can understand, validate, and contribute 
                  to the data model's evolution.
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- Technical Section -->
        <section id="technical" class="scroll-mt-24">
          <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2">
            <span class="text-clif-burgundy">02</span>
            Technical Details
          </h2>
          
          <!-- Data Granularity -->
          <div class="faq-item bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover-lift mb-4 border border-gray-100 overflow-hidden">
            <button class="faq-trigger w-full text-left p-6 focus:outline-none focus:ring-2 focus:ring-clif-burgundy focus:ring-inset" aria-expanded="false">
              <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-blue-100 to-blue-200 rounded-xl flex items-center justify-center">
                  <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                  </svg>
                </div>
                <div class="flex-1">
                  <h3 class="text-xl font-semibold text-gray-900 mb-1">What level of data granularity does CLIF support?</h3>
                  <p class="text-gray-600 text-sm">Understanding CLIF's data capture capabilities</p>
                </div>
                <svg class="faq-chevron w-5 h-5 text-gray-400 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              </div>
            </button>
            <div class="faq-content hidden px-6 pb-6">
              <div class="ml-16">
                <p class="text-lg text-gray-700 leading-relaxed">
                  CLIF captures detailed ICU data including ventilator settings throughout the stay (FiO2, PEEP changes), 
                  vasoactive drug titrations, and other critical parameters. While the schema supports high-frequency data, 
                  current federated analyses focus on clinically meaningful time intervals that balance detail with 
                  practical research needs.
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- Getting Started Section -->
        <section id="joining" class="scroll-mt-24">
          <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2">
            <span class="text-clif-burgundy">03</span>
            Getting Started
          </h2>
          
          <!-- Join CLIF -->
          <div class="faq-item bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover-lift mb-4 border border-gray-100 overflow-hidden">
            <button class="faq-trigger w-full text-left p-6 focus:outline-none focus:ring-2 focus:ring-clif-burgundy focus:ring-inset" aria-expanded="false">
              <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-green-100 to-green-200 rounded-xl flex items-center justify-center">
                  <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/>
                  </svg>
                </div>
                <div class="flex-1">
                  <h3 class="text-xl font-semibold text-gray-900 mb-1">How can my institution join CLIF?</h3>
                  <p class="text-gray-600 text-sm">Steps to become part of our consortium</p>
                </div>
                <svg class="faq-chevron w-5 h-5 text-gray-400 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              </div>
            </button>
            <div class="faq-content hidden px-6 pb-6">
              <div class="ml-16 space-y-4">
                <p class="text-lg text-gray-700 leading-relaxed">
                  We welcome new collaborators! The CLIF consortium is actively growing, with 18 institutions already participating 
                  and 10 sites contributing data. To join:
                </p>
                <ol class="list-decimal list-inside space-y-3 text-lg text-gray-700">
                  <li class="flex items-start">
                    <span class="font-semibold mr-2">1.</span>
                    <span>Contact us at 
                      <button 
                        class="email-copy text-clif-burgundy hover:text-clif-burgundy-dark underline inline-flex items-center gap-1"
                        data-email="clif_consortium@uchicago.edu"
                      >
                        clif_consortium@uchicago.edu
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                      </button>
                    </span>
                  </li>
                  <li class="flex items-start">
                    <span class="font-semibold mr-2">2.</span>
                    <span>We'll schedule a call to discuss your institution's needs and capabilities</span>
                  </li>
                  <li class="flex items-start">
                    <span class="font-semibold mr-2">3.</span>
                    <span>Our team will guide you through the implementation process</span>
                  </li>
                  <li class="flex items-start">
                    <span class="font-semibold mr-2">4.</span>
                    <span>Join our collaborative research network</span>
                  </li>
                </ol>
              </div>
            </div>
          </div>

          <!-- Research Projects -->
          <div class="faq-item bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover-lift mb-4 border border-gray-100 overflow-hidden">
            <button class="faq-trigger w-full text-left p-6 focus:outline-none focus:ring-2 focus:ring-clif-burgundy focus:ring-inset" aria-expanded="false">
              <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-indigo-100 to-indigo-200 rounded-xl flex items-center justify-center">
                  <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                  </svg>
                </div>
                <div class="flex-1">
                  <h3 class="text-xl font-semibold text-gray-900 mb-1">I have a research project idea using CLIF. Who should I contact?</h3>
                  <p class="text-gray-600 text-sm">Proposing research with CLIF data</p>
                </div>
                <svg class="faq-chevron w-5 h-5 text-gray-400 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              </div>
            </button>
            <div class="faq-content hidden px-6 pb-6">
              <div class="ml-16">
                <p class="text-lg text-gray-700 leading-relaxed">
                  We're excited to support innovative critical care research projects! Please email us at 
                  <button 
                    class="email-copy text-clif-burgundy hover:text-clif-burgundy-dark underline inline-flex items-center gap-1"
                    data-email="clif_consortium@uchicago.edu"
                  >
                    clif_consortium@uchicago.edu
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                    </svg>
                  </button> 
                  with a brief description of your project. Our scientific committee reviews proposals and can help connect you 
                  with participating sites and resources.
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="scroll-mt-24">
          <div class="bg-gradient-to-br from-clif-burgundy/5 via-clif-burgundy/10 to-clif-burgundy/5 rounded-2xl p-8 border border-clif-burgundy/20 text-center relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-br from-clif-burgundy/5 to-transparent opacity-50"></div>
            <div class="relative z-10">
              <div class="inline-flex items-center justify-center w-16 h-16 bg-white rounded-full shadow-lg mb-4">
                <svg class="w-8 h-8 text-clif-burgundy" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
              </div>
              <h2 class="text-2xl font-bold mb-4 text-gray-800">Have More Questions?</h2>
              <p class="text-lg text-gray-700 mb-6 max-w-2xl mx-auto">
                We're here to help! Whether you're interested in implementing CLIF, proposing research, or learning more about our consortium, 
                don't hesitate to reach out.
              </p>
              <CTAButton 
                href="mailto:clif_consortium@uchicago.edu" 
                size="large"
                ariaLabel="Email the CLIF Consortium"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
                Email Us
              </CTAButton>
            </div>
          </div>
        </section>

      </div>
    </div>
  </div>

  <!-- Back to Top Button -->
  <button 
    id="back-to-top" 
    class="fixed bottom-8 right-8 w-12 h-12 bg-clif-burgundy text-white rounded-full shadow-lg hover:bg-clif-burgundy-dark transition-all duration-300 opacity-0 invisible"
    aria-label="Back to top"
  >
    <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
    </svg>
  </button>

  <!-- Copy notification -->
  <div id="copy-notification" class="fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-4 py-2 rounded-lg shadow-lg opacity-0 invisible transition-all duration-300">
    Email copied to clipboard!
  </div>
</BaseLayout>

<style>
  .faq-item {
    contain: layout style;
  }
  
  .faq-content {
    transition: all 0.3s ease-out;
    max-height: 0;
    overflow: hidden;
  }
  
  .faq-item.active .faq-content {
    max-height: 1000px;
  }
  
  .faq-item.active .faq-chevron {
    transform: rotate(180deg);
  }
  
  .email-copy {
    position: relative;
  }
  
  .email-copy:hover svg {
    opacity: 1;
  }
  
  .email-copy svg {
    opacity: 0.7;
    transition: opacity 0.2s;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Accordion functionality
    const faqItems = document.querySelectorAll('.faq-item');
    
    faqItems.forEach(item => {
      const trigger = item.querySelector('.faq-trigger');
      const content = item.querySelector('.faq-content');
      
      trigger?.addEventListener('click', () => {
        const isActive = item.classList.contains('active');
        
        // Close all other items
        faqItems.forEach(otherItem => {
          if (otherItem !== item) {
            otherItem.classList.remove('active');
            otherItem.querySelector('.faq-content')?.classList.add('hidden');
            otherItem.querySelector('.faq-trigger')?.setAttribute('aria-expanded', 'false');
          }
        });
        
        // Toggle current item
        if (isActive) {
          item.classList.remove('active');
          content?.classList.add('hidden');
          trigger.setAttribute('aria-expanded', 'false');
        } else {
          item.classList.add('active');
          content?.classList.remove('hidden');
          trigger.setAttribute('aria-expanded', 'true');
        }
      });
    });
    
    // Copy email functionality
    const emailButtons = document.querySelectorAll('.email-copy');
    const notification = document.getElementById('copy-notification');
    
    emailButtons.forEach(button => {
      button.addEventListener('click', async (e) => {
        e.preventDefault();
        e.stopPropagation();
        
        const email = button.getAttribute('data-email');
        if (email) {
          try {
            await navigator.clipboard.writeText(email);
            
            // Show notification
            notification?.classList.remove('opacity-0', 'invisible');
            notification?.classList.add('opacity-100', 'visible');
            
            // Hide after 2 seconds
            setTimeout(() => {
              notification?.classList.remove('opacity-100', 'visible');
              notification?.classList.add('opacity-0', 'invisible');
            }, 2000);
          } catch {
            // Failed to copy email
          }
        }
      });
    });
    
    // Back to top button
    const backToTopButton = document.getElementById('back-to-top');
    
    window.addEventListener('scroll', () => {
      if (window.pageYOffset > 300) {
        backToTopButton?.classList.remove('opacity-0', 'invisible');
        backToTopButton?.classList.add('opacity-100', 'visible');
      } else {
        backToTopButton?.classList.remove('opacity-100', 'visible');
        backToTopButton?.classList.add('opacity-0', 'invisible');
      }
    });
    
    backToTopButton?.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    
    // Active section highlighting
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('aside nav a');
    
    const observerOptions = {
      rootMargin: '-100px 0px -66%',
      threshold: 0
    };
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const id = entry.target.getAttribute('id');
          
          navLinks.forEach(link => {
            if (link.getAttribute('href') === `#${id}`) {
              link.classList.add('text-clif-burgundy', 'bg-clif-burgundy/5');
              link.classList.remove('text-gray-600');
            } else {
              link.classList.remove('text-clif-burgundy', 'bg-clif-burgundy/5');
              link.classList.add('text-gray-600');
            }
          });
        }
      });
    }, observerOptions);
    
    sections.forEach(section => {
      observer.observe(section);
    });
  });
</script>